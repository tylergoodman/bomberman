<!DOCTYPE html>
<html>
<body>

<head>
	<script src="GameObject.js" type="text/javascript" ></script>
	<script src="Player.js" type="text/javascript" ></script>
	<script src="GameView.js" type="text/javascript" ></script>
</head>

<script language="JavaScript" type="text/JavaScript">

/******************************************************************************
							Constants
******************************************************************************/
var MOVESPEED = 20;
/******************************************************************************
						End of Constants
******************************************************************************/

/******************************************************************************
						Initialization / Declarations
******************************************************************************/
/******************************************************************************
					End of Initialization / Declarations
******************************************************************************/

/******************************************************************************
							Game Functions
******************************************************************************/

function move(direction)
{	

	// find bomberman's row/col
	var row = bomberman.getRow();
	var col = bomberman.getCol();

	if(direction == "RIGHT")
	{
		col += 1;
	}
	else if(direction == "LEFT")
	{
		col -= 1;
	}
	else if(direction == "UP")
	{
		row -= 1;
	}
	else if(direction == "DOWN")
	{
		row += 1;
	}

	// Set bomberman's gameobject row/col to new value
	bomberman.setCol(col);
	bomberman.setRow(row);

	// Clear the board
	gameView.ClearCanvas();

	// draw bomberman's new image location
	gameView.draw(bomberman.Image, bomberman.getCol() * MOVESPEED, 
		bomberman.getRow() * MOVESPEED);
}

// function returns an object that contains an element's x and y position
// Ex: var temp = getPosition("element");
//	   var width = temp.x;
//	   var height = temp.y;
//
function getPosition(element) {
    var xPosition = 0;
    var yPosition = 0;
  
    while(element) {
        xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);
        yPosition += (element.offsetTop - element.scrollTop + element.clientTop);
        element = element.offsetParent;
    }
    return { x: xPosition, y: yPosition };
}

/******************************************************************************
						End of Game Functions
******************************************************************************/

/******************************************************************************
							Events/Event Handlers
******************************************************************************/

// Event when a key is hit: converts the key to a string
function showKey(e) {
	var key;
	if (window.event) {
		key = window.event.keyCode;
	} 
	else {
		key = e.keyCode;
	}

	key = String.fromCharCode(key);
	ProcessKey(key);
}

// Processes a key press event
function ProcessKey(key)
{
	if (key == "A")
	{
		move("LEFT");
	}
	else if(key == "D")
	{
		move("RIGHT");
	}
	else if(key == "W")
	{
		move("UP");
	}
	else if(key == "S")
	{
		move("DOWN");
	}
}

// Sets up the keyboard event listener
window.onload = function() {
	document.onkeydown = showKey;
}

/******************************************************************************
					End of Events/Event Handlers
******************************************************************************/

/******************************************************************************
								Main
******************************************************************************/
// Create View
var gameView = new GameView();

// Create an image object and sets it as bomberman
var bomberman = new Player("Player 1", 1, 1);

// clears canvas
gameView.ClearCanvas();

/******************************************************************************
						Set Up Initial Image Loading
******************************************************************************/

bomberman.Image.onload = function ()
{
	gameView.draw(bomberman.Image, 10,10);
}
/******************************************************************************
						End Initial Image Loading
******************************************************************************/


/******************************************************************************
							End of Main
******************************************************************************/

</script>


</body>
</html>
